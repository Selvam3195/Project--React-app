version: 0.0

Resources:
  - my-k8s-service:

    Type: Kubernetes::Service
    Properties:
      TaskDefinition: manifest/deployment.yaml
      AppSpecContent:
        Files:
          - source: /
            destination: /app

hooks:
  BeforeInstall:
    - location: scripts/before_install.sh
      timeout: 180
      runas: root

  AfterInstall:
    - location: scripts/after_install.sh
      timeout: 180
      runas: root

  ApplicationStart:
    - location: scripts/start_k8s.sh
      timeout: 300
      runas: root

  ValidateService:
    - location: scripts/validate.sh
      timeout: 120
      runas: root
